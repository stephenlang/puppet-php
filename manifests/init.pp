# init.pp

class php (
  $package_list                    = $php::params::package_list,
  $service_name                    = $php::params::service_name,
  $php_d                           = $php::params::php_d,
  $php_ini                         = $php::params::php_ini,
  $engine                          = $php::params::engine,
  $short_open_tag                  = $php::params::short_open_tag,
  $asp_tags                        = $php::params::asp_tags,
  $precision                       = $php::params::precision,
  $y2k_compliance                  = $php::params::y2k_compliance,
  $output_buffering                = $php::params::output_buffering,
  $zlib_output_compression         = $php::params::zlib_output_compression,
  $implicit_flush                  = $php::params::implicit_flush,
  $unserialize_callback_func       = $php::params::unserialize_callback_func,
  $serialize_precision             = $php::params::serialize_precision,
  $allow_call_time_pass_reference  = $php::params::allow_call_time_pass_reference,
  $safe_mode                       = $php::params::safe_mode,
  $safe_mode_gid                   = $php::params::safe_mode_gid,
  $safe_mode_include_dir           = $php::params::safe_mode_include_dir,
  $safe_mode_exec_dir              = $php::params::safe_mode_exec_dir,
  $safe_mode_allowed_env_vars      = $php::params::safe_mode_allowed_env_vars,
  $safe_mode_protected_env_vars    = $php::params::safe_mode_protected_env_vars,
  $disable_functions               = $php::params::disable_functions,
  $disable_classes                 = $php::params::disable_classes,
  $expose_php                      = $php::params::expose_php,
  $max_execution_time              = $php::params::max_execution_time,
  $max_input_time                  = $php::params::max_input_time,
  $memory_limit                    = $php::params::memory_limit,
  $error_reporting                 = $php::params::error_reporting,
  $display_errors                  = $php::params::display_errors,
  $display_startup_errors          = $php::params::display_startup_errors,
  $log_errors                      = $php::params::log_errors,
  $log_errors_max_len              = $php::params::log_errors_max_len,
  $ignore_repeated_errors          = $php::params::ignore_repeated_errors,
  $ignore_repeated_source          = $php::params::ignore_repeated_source,
  $report_memleaks                 = $php::params::report_memleaks,
  $track_errors                    = $php::params::track_errors,
  $html_errors                     = $php::params::html_errors,
  $variables_order                 = $php::params::variables_order,
  $request_order                   = $php::params::request_order,
  $register_globals                = $php::params::register_globals,
  $register_long_arrays            = $php::params::register_long_arrays,
  $register_argc_argv              = $php::params::register_argc_argv,
  $auto_globals_jit                = $php::params::auto_globals_jit,
  $post_max_size                   = $php::params::post_max_size,
  $magic_quotes_gpc                = $php::params::magic_quotes_gpc,
  $magic_quotes_runtime            = $php::params::magic_quotes_runtime,
  $magic_quotes_sybase             = $php::params::magic_quotes_sybase,
  $auto_prepend_file               = $php::params::auto_prepend_file,
  $auto_append_file                = $php::params::auto_append_file,
  $default_mimetype                = $php::params::default_mimetype,
  $doc_root                        = $php::params::doc_root,
  $user_dir                        = $php::params::user_dir,
  $enable_dl                       = $php::params::enable_dl,
  $file_uploads                    = $php::params::file_uploads,
  $upload_max_filesize             = $php::params::upload_max_filesize,
  $allow_url_fopen                 = $php::params::allow_url_fopen,
  $allow_url_include               = $php::params::allow_url_include,
  $default_socket_timeout          = $php::params::default_socket_timeout,
  $define_syslog_variables         = $php::params::define_syslog_variables,
  $SMTP                            = $php::params::SMTP,
  $smtp_port                       = $php::params::smtp_port,
  $sendmail_path                   = $php::params::sendmail_path,
  $mail_add_x_header               = $php::params::mail_add_x_header,
  $sql_safe_mode                   = $php::params::sql_safe_mode,
  $odbc_allow_persistent           = $php::params::odbc_allow_persistent,
  $odbc_check_persistent           = $php::params::odbc_check_persistent,
  $odbc_max_persistent             = $php::params::odbc_max_persistent,
  $odbc_max_links                  = $php::params::odbc_max_links,
  $odbc_defaultlrl                 = $php::params::odbc_defaultlrl,
  $odbc_defaultbinmode             = $php::params::odbc_defaultbinmode,
  $mysql_allow_persistent          = $php::params::mysql_allow_persistent,
  $mysql_max_persistent            = $php::params::mysql_max_persistent,
  $mysql_max_links                 = $php::params::mysql_max_links,
  $mysql_default_port              = $php::params::mysql_default_port,
  $mysql_default_socket            = $php::params::mysql_default_socket,
  $mysql_default_host              = $php::params::mysql_default_host,
  $mysql_default_user              = $php::params::mysql_default_user,
  $mysql_default_password          = $php::params::mysql_default_password,
  $mysql_connect_timeout           = $php::params::mysql_connect_timeout,
  $mysql_trace_mode                = $php::params::mysql_trace_mode,
  $mysqli_max_links                = $php::params::mysqli_max_links,
  $mysqli_default_port             = $php::params::mysqli_default_port,
  $mysqli_default_socket           = $php::params::mysqli_default_socket,
  $mysqli_default_host             = $php::params::mysqli_default_host,
  $mysqli_default_user             = $php::params::mysqli_default_user,
  $mysqli_default_pw               = $php::params::mysqli_default_pw,
  $mysqli_reconnect                = $php::params::mysqli_reconnect,
  $pgsql_allow_persistent          = $php::params::pgsql_allow_persistent,
  $pgsql_auto_reset_persistent     = $php::params::pgsql_auto_reset_persistent,
  $pgsql_max_persistent            = $php::params::pgsql_max_persistent,
  $pgsql_max_links                 = $php::params::pgsql_max_links,
  $pgsql_ignore_notice             = $php::params::pgsql_ignore_notice,
  $pgsql_log_notice                = $php::params::pgsql_log_notice,
  $sybct_allow_persistent          = $php::params::sybct_allow_persistent,
  $sybct_max_persistent            = $php::params::sybct_max_persistent,
  $sybct_max_links                 = $php::params::sybct_max_links,
  $sybct_min_server_severity       = $php::params::sybct_min_server_severity,
  $sybct_min_client_severity       = $php::params::sybct_min_client_severity,
  $bcmath_scale                    = $php::params::bcmath_scale,
  $session_save_handler            = $php::params::session_save_handler,
  $session_save_path               = $php::params::session_save_path,
  $session_use_cookies             = $php::params::session_use_cookies,
  $session_use_only_cookies        = $php::params::session_use_only_cookies,
  $session_name                    = $php::params::session_name,
  $session_auto_start              = $php::params::session_auto_start,
  $session_cookie_lifetime         = $php::params::session_cookie_lifetime,
  $session_cookie_path             = $php::params::session_cookie_path,
  $session_cookie_domain           = $php::params::session_cookie_domain,
  $session_cookie_httponly         = $php::params::session_cookie_httponly,
  $session_serialize_handler       = $php::params::session_serialize_handler,
  $session_gc_probability          = $php::params::session_gc_probability,
  $session_gc_divisor              = $php::params::session_gc_divisor,
  $session_gc_maxlifetime          = $php::params::session_gc_maxlifetime,
  $session_bug_compat_42           = $php::params::session_bug_compat_42,
  $session_bug_compat_warn         = $php::params::session_bug_compat_warn,
  $session_referer_check           = $php::params::session_referer_check,
  $session_entropy_length          = $php::params::session_entropy_length,
  $session_entropy_file            = $php::params::session_entropy_file,
  $session_cache_limiter           = $php::params::session_cache_limiter,
  $session_cache_expire            = $php::params::session_cache_expire,
  $session_use_trans_sid           = $php::params::session_use_trans_sid,
  $session_hash_function           = $php::params::session_hash_function,
  $session_hash_bits_per_character = $php::params::session_hash_bits_per_character,
  $url_rewriter_tags               = $php::params::url_rewriter_tags,
  $mssql_allow_persistent          = $php::params::mssql_allow_persistent,
  $mssql_max_persistent            = $php::params::mssql_max_persistent,
  $mssql_max_links                 = $php::params::mssql_max_links,
  $mssql_min_error_severity        = $php::params::mssql_min_error_severity,
  $mssql_min_message_severity      = $php::params::mssql_min_message_severity,
  $mssql_compatability_mode        = $php::params::mssql_compatability_mode,
  $mssql_secure_connection         = $php::params::mssql_secure_connection,
  $tidy_clean_output               = $php::params::tidy_clean_output,
  $soap_wsdl_cache_enabled         = $php::params::soap_wsdl_cache_enabled,
  $soap_wsdl_cache_dir             = $php::params::soap_wsdl_cache_dir,
  $soap_wsdl_cache_ttl             = $php::params::soap_wsdl_cache_ttl,
) inherits php::params {

  package {
    $package_list: ensure => installed
  }

  file { $php_ini:
      content => template('php/php.ini.erb'),
      owner   => 'root',
      group   => 'root',
      mode    => '644',
      notify  => Service [$service_name], # Will restart service after change
  }

  service { $service_name:
    ensure     => running,
    enable     => true,
    hasstatus  => true,
    hasrestart => true,
  }
}
